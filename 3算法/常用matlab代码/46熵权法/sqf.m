clc;clear
data=[0.75	0.63	0.75	0.81	0.69	0.81	5	10	1.93548E+11	7240.681967	6.298785927	0.62 	192.4661076	4.686888049	2.0	3.400000095	0.115836213	96.97335856	15.38125957	101.7018861	6.499	4	6	6	7.6	6.6	23.1	31	4.8	2.431582014	9.5	-3.61798E-05	1	1
0.75	0.5	0.69	0.81	0.63	0.75	5	10.5	2.30814E+11	8486.599333	4.831769895	0.75 	176.6685921	3.280791297	5.4	3.5	0.116569495	97.55335372	16.85965181	103.3669954	4.808180972	4	6	5.7	7.6	6.5	18.9	20	4.8	2.186625121	9.5	4.54671E-05	1	1
0.75	0.5	0.69	0.81	0.63	0.75	5	10.5	2.02258E+11	7312.008314	-1.513685083	2.82 	162.5590474	0.056692279	0.6	5.199999809	0.133067151	94.79421005	15.72300017	99.20792011	3.626565493	4	6	5.6	7.8	6.4	15.6	18	4.7	2.018688231	9.5	0.004690208	1	1
0.75	0.5	0.69	0.81	0.63	0.75	5	10.5	2.55017E+11	9069.041757	7.425970496	3.14 	157.9448161	4.268585079	1.7	5.199999809	0.138986262	100	10.58680811	99.78332539	3.354026707	4	6	6	7.9	7.1	17.5	17	4.8	1.909757926	9.5	0.000150235	1	1
0.69	0.5	0.69	0.81	0.63	0.75	5	10.5	2.97952E+11	10427.75605	5.293784657	3.11 	154.9377943	5.07443252	3.2	5.300000191	0.140462949	100.3691636	11.24594845	100.661092	2.681390308	4	6	6	8	7.5	16.4	5	4.7	1.94	9.5	6.29193E-05	1	1
0.69	0.5	0.69	0.81	0.63	0.75	5	10.5	3.14443E+11	10834.65908	5.473454192	3.04 	147.841804	2.829059379	1.7	4.900000095	0.16529799	100.1058325	5.927298365	100.9644134	2.015843113	4	6	6	8	7.5	15.1	6	4.7	1.92	9.5	0.000223747	1	1
0.69	0.5	0.69	0.81	0.63	0.75	5	10.5	3.23343E+11	10973.65594	4.713453716	3.04 	142.691994	3.493591567	2.1	4.900000095	0.174524422	100.5891618	3.628205878	100.5497696	1.849146571	4	6	6	8	7.5	7.6	6	4.7	1.89	9.5	0.000545649	1	1
];
 
fzb=data(:,[1 2 3 7 8 12 15 16 17 21 22 23 27 28 30 31]);%取负指标
zzb=data(:,[4 5 6 9:11 13 14 18:20 24:26 29 32:34]);%取正指标
M=zzb;
x2=fzb;


N = (M - min(M(:)))/(max(M(:))-min(M(:)));%正指标归一化
N2 = ( max(x2(:))-x2)/(max(x2(:))-min(x2(:)));%负指标归一化
x=[N2(:,[1 2 3]),N(:,[1 2 3]),N2(:,[4 5]),N(:,4:6),N2(:,6),N(:,7:8),N2(:,[7 8 9]),N(:,9:11),N2(:,[10 11 12]),N(:,12:14),N2(:,[13 14]),N(:,15),N2(:,[15 16]),N(:,16:18)];
x1=x
y=[];
[m,n]=size(x1);
for i=1:n
   y(:,i)=x1(:,i)/sum([x1(:,i)])   ;    % 矩阵标准化
end
    
    

    
for l=1:n
    s(1,l)=0;
    for j=1:m
       if y(j,l)==0;%%%%%%%%“==”表示等于“=”是赋值
           p(1,l)=0;
            s(1,l)=s(1,l);
        else    
        p(1,l)=y(j,l)*log(y(j,l));
        s(1,l)=s(1,l)+p(1,l);
         end
    end
end
k=(log(m))^(-1);
e=-k*s;
h=ones(1,n)-e;
w=h/sum(h)          % 指标权重值

